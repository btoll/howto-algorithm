#include <stdio.h>
#include <string.h>

//
// Run the following commands:
//
//      gcc -fno-stack-protector strcpy.c               // Turn off gcc protection against buffer overflows.
//      ./vuln $(perl -e 'print "a"x24 . "\x5b\x84\x04\x08"')
//

void foo(char *s) {
    char buf[12];

    strcpy(buf, s);
    printf("The text is: `%s`\n", buf);
}

int main(int argc, char *argv[]) {
    if (argc == 1) {
        printf("Not enough args\n");
        return 1;
    }

    foo(argv[1]);

    return 0;
}

